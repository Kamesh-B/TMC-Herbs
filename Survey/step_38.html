<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Step 38 • Feelings About Your Journey</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{ --pink:#e75480; --pink-light:#ffe6ec; --pink-shadow:rgba(231,84,128,.25);
           --border:#EDEDF2; --hover:#F8F8F8; --text:#212124; --muted:#6D6E71; }
    html{line-height:1.15;-webkit-text-size-adjust:100%}
    body{margin:0;font-family:'Manrope',-apple-system,BlinkMacSystemFont,sans-serif;background:#fff;color:var(--text)}
    *,:after,:before{box-sizing:border-box;border:0 solid var(--border)}
    html,body{height:100%}

    #__next{display:flex;flex-direction:column;margin:0 auto;max-width:430px;width:100%;min-height:100%;background:#fff;position:relative}
    .main-content-section{flex:1 1 auto;display:flex;justify-content:center;align-items:center;padding:32px 20px 24px}
    .content-wrapper{width:100%;max-width:430px}

    /* Header */
    .header-section{position:sticky;top:0;z-index:10;background:#fff;padding-top:12px}
    .header-container{display:flex;align-items:center;justify-content:center;padding:12px 20px}
    .logo{width:80px}
    .separator{border:none;border-top:1px solid var(--border);margin:0}

    /* Title */
    .title-container{display:flex;justify-content:center;margin-bottom:8px;padding:0 4px}
    .title-text{color:var(--text);font-size:22px;font-weight:700;line-height:1.25;text-align:center}
    .subtitle{color:#5F6166;font-size:14px;text-align:center;margin-bottom:16px}

    /* Options */
    .options-list{display:grid;grid-template-columns:1fr;gap:10px}
    .option{border:1px solid var(--border);border-radius:14px;padding:14px;text-align:center;font-weight:700;font-size:16px;letter-spacing:-.01em;user-select:none;transition:background .2s,border-color .2s,box-shadow .2s,color .2s;background:#fff;color:var(--text)}
    .option:hover{background:var(--hover);border-color:#DADBE3}
    .option[aria-pressed="true"]{background:var(--pink-light);border-color:var(--pink);box-shadow:inset 0 0 0 2px var(--pink-shadow);color:#7a1b46}

    /* Nav */
    .nav{display:flex;gap:10px;margin-top:18px}
    .btn{flex:1;border-radius:14px;padding:14px 16px;font-weight:700;font-size:16px;text-align:center;border:1px solid var(--border);background:#fff;color:var(--text);transition:background .2s}
    .btn:hover{background:var(--hover)}
    .btn.primary{background:var(--pink);color:#fff;border-color:var(--pink)}
    .btn.primary[disabled]{opacity:.45;cursor:not-allowed}

    /* Footer */
    .footer-section{padding:0;display:flex;justify-content:center}
    .footer-container{width:100%;padding:16px;display:flex;flex-direction:column;justify-content:center;gap:8px;align-items:center;border-top:1px solid var(--border);background:#fff}
    .footer-links{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;gap:6px}
    .footer-link{font-size:12px;font-weight:400;color:var(--muted);text-decoration:none}
    .footer-separator{margin:0 5px;color:#d3d3d3}
  </style>
</head>
<body>
  <div id="__next">
    <!-- Header -->
    <section class="header-section" aria-label="Header">
      <div class="header-container">
        <img class="logo" src="https://static.wixstatic.com/media/c70145_6f9d2c9d30da4051a7678b3d1ee8e175~mv2.png/v1/fill/w_176,h_182,al_c,q_85,usm_0.66_1.00_0.01,enc_avif,quality_auto/c70145_948fe39b8daf48799a907c089cac9b9a~.png" alt="App logo" />
      </div>
      <hr class="separator" />
    </section>

    <!-- Main -->
    <section class="main-content-section" aria-labelledby="anger-title">
      <div class="content-wrapper">
        <div class="title-container">
          <h1 id="anger-title" class="title-text">
            Do you ever feel angry or frustrated about what <span id="problem-text">this phase</span> has put you through?
          </h1>
        </div>
        <p class="subtitle">Choose the best match for you.</p>

        <div class="options-list" id="options" role="radiogroup" aria-label="Feelings about the problem">
          <button class="option" type="button" data-value="anger_furious" aria-pressed="false" role="radio" aria-checked="false">
            Yes, I’m furious that these symptoms have taken over my life
          </button>
          <button class="option" type="button" data-value="anger_sometimes" aria-pressed="false" role="radio" aria-checked="false">
            Sometimes, I get frustrated but I try to roll with it
          </button>
          <button class="option" type="button" data-value="anger_accept" aria-pressed="false" role="radio" aria-checked="false">
            Not really, I’ve learned to accept the changes
          </button>
        </div>

        <div class="nav" role="navigation">
          <a id="backBtn" href="#" class="btn" aria-label="Back to previous step">Back</a>
          <button id="nextBtn" class="btn primary" disabled aria-disabled="true" aria-label="Continue to next step">Continue</button>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <section class="footer-section">
      <footer class="footer-container" aria-label="Footer">
        <div class="footer-links">
          <a class="footer-link" href="#">Terms</a>
          <span class="footer-separator">•</span>
          <a class="footer-link" href="#">Privacy</a>
          <span class="footer-separator">•</span>
          <a class="footer-link" href="#">Support</a>
        </div>
      </footer>
    </section>
  </div>

  <script>
    (function(){
      const KEY='menopause-quiz';
      const SID_KEY='quiz_session_id';
      const PREV='step_37.html';
      const NEXT='step_39.html';

      // helpers
      function get(){ try{return JSON.parse(localStorage.getItem(KEY))||{};}catch{return{};} }
      function setAll(o){ localStorage.setItem(KEY, JSON.stringify(o)); }
      function setAns(k,v){ const d=get(); d[k]=v; setAll(d); }

      function stagePhrase(s){
        if(!s) return 'this phase';
        s = String(s).toLowerCase();
        if(s.includes('peri')) return 'perimenopause';
        if(s.includes('post')) return 'postmenopause';
        if(s.includes('pre')) return 'pre-menopause';
        if(s.includes('meno')) return 'menopause';
        return 'this phase';
      }

      const params = new URLSearchParams(location.search);

      // ensure sid in query
      let sid = localStorage.getItem(SID_KEY);
      if(!sid){
        sid = (crypto.randomUUID ? crypto.randomUUID() :
          ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,c=>(c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)));
        localStorage.setItem(SID_KEY, sid);
      }
      if(!params.get('sid')) params.set('sid', sid);

      // Fill {Problem} from URL or stored answers
      const answers = get();
      const rawStage = params.get('stage') || answers.stage || '';
      document.getElementById('problem-text').textContent = stagePhrase(rawStage);

      // UI wiring
      const list=document.getElementById('options');
      const nextBtn=document.getElementById('nextBtn');
      const backBtn=document.getElementById('backBtn');

      function update(){
        const sel=list.querySelector('.option[aria-pressed="true"]');
        const on=!!sel;
        nextBtn.disabled=!on;
        nextBtn.setAttribute('aria-disabled', String(!on));
      }

      list.addEventListener('click', e=>{
        const btn=e.target.closest('.option'); if(!btn) return;
        list.querySelectorAll('.option').forEach(b=>{b.setAttribute('aria-pressed','false'); b.setAttribute('aria-checked','false');});
        btn.setAttribute('aria-pressed','true'); btn.setAttribute('aria-checked','true');
        update();
      });

      list.querySelectorAll('.option').forEach(b=>{
        b.addEventListener('keydown', e=>{
          if(e.key==='Enter'||e.key===' '){ e.preventDefault(); b.click(); }
        });
      });

      backBtn.addEventListener('click', e=>{
        e.preventDefault();
        const qs=params.toString();
        location.href=`${PREV}${qs?('?' + qs):''}`;
      });

      nextBtn.addEventListener('click', ()=>{
        const sel=list.querySelector('.option[aria-pressed="true"]'); if(!sel) return;
        const val=sel.dataset.value;
        setAns('anger_about_problem', val);
        params.set('anger_about_problem', val);
        location.href=`${NEXT}?${params.toString()}`;
      });
    })();
  </script>
</body>
</html>
